<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Linghua Zhang" />
    
    <title>Find the position of fingertips and fingervalleys</title>
    
    <link rel="shortcut icon" href="/media/favicon.ico">
    <link rel="stylesheet" type=text/css href="/media/css/style.css">
    <link rel="stylesheet" type=text/css href="/media/css/github.css">
	<link rel="stylesheet" href="/media/css/font-awesome.min.css">
	<link href="/atom.xml" rel="alternate" title="The Journey Is the Reward" type="application/atom+xml" />
    <!--[if IE 7]>
    <link rel="stylesheet" href="/media/css/fontawesome-ie7.css">
    <![endif]-->
    <script type="text/javascript" src="/media/js/highlight.pack.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>
  </head>
  <body>
      <div id="main" role="main">
        <header>
          <div id="header">
            <h1><a title="The Journey Is the Reward" class="" href="/">The Journey Is the Reward</a></h1>
          </div>
          <nav>
			<span><a title="About" class="icon-user" href="/about.html"></a></span>
			<span><a title="Resume" class="icon-list-ol" href="/Curriculum_Vitae.pdf"></a></span>
			<span><a title="Publication" class="icon-book" href="/publication.html"></a></span>
            <span><a title="Archive" class="icon-cloud" href="/archive.html"></a></span>
            <span><a title="Tags" class="icon-tags" href="/tags.html"></a></span>
            <span><a title="Projects" class="icon-film" href="/projects.html"></a></span>
            <span><a title="Subscribe" class="icon-rss" href="/atom.xml"></a></span>
          </nav>
        </header>
        <div id="content">
        <article>
  <section class="title">
    <h2>Find the position of fingertips and fingervalleys </h2>
  </section>
  <section class="meta">
  <span class="time">
    <time datetime="2013-11-23">2013-11-23</time>
  </span>
  
  <span class="tags">
    
    <a href="/tags.html#Hand Gesture Recognition" title="Hand Gesture Recognition">#Hand Gesture Recognition</a>
    
  </span>
  
  </section>
  <section class="post">
  <h3>Plan A</h3>

<p>After obtaining the <em>time-series curve</em>, we can find the positions of the fingertips and fingerroots.</p>

<p>I decided to find the lowest points between every two fingers and the ones at the start of the thumb and end of the little finger (I refer them as fingervalleys). How to do that? Well, I assume they are all the lowest points in the time-series curve. But this brings another issue, because there are many points thet are locally lowest, but they are not the points I was looking for. So in order to eliminate these error points, I assume that for every fingervalley, there is also a fingertip whose height should surpass a certain threshold.</p>

<p>After the fingervalleys are detected, it's easy to detect the fingertip, you just have to find the highest points in the graph.</p>

<p>After finding the fingertips, we need to locate the fingerroots for every finger (the points are the root of every finger). This is done by comparing the neighboring widths below every fingertip, the search begins from the fingertips and ends to the fingervalleys, the detail is below:</p>

<pre><code>if (the latter width &gt; constant * the former width &amp;&amp; the fingerroots are at the bottom of fingers)
    find the fingerroots
else
    keep finding the next width
end
</code></pre>

<p>The code for this task is as follows:</p>

<pre><code>function [fingeredge,fingertip]=finger_finder1(degree,norm_distance)
j=1;
firstTime=1;
finger_edge=1;
length=size(degree,2);
fingervalley=zeros(1,6);
min_distance=norm_distance(1);
max_distance=norm_distance(1);
for i=1:length
    if(norm_distance(i)&lt;min_distance)
        min_distance=norm_distance(i);
        max_distance=norm_distance(i);
        if(min_distance-norm_distance(finger_edge)&lt;0.027)
            finger_edge=i;
        end
    elseif(norm_distance(i)&lt;max_distance)
        if(max_distance-norm_distance(finger_edge)&gt;0.2)%0.26
            fingervalley(j)=finger_edge;
            j=j+1;
            firstTime=~firstTime;
        end
        min_distance=norm_distance(i);
        max_distance=norm_distance(i);
    elseif(norm_distance(i)&gt;max_distance)
        if(firstTime)
            finger_edge=i-1;
            firstTime=~firstTime;
        end
        max_distance=norm_distance(i);
    end
end

%remove invalid valley
j=1;
length=find(fingervalley, 1, 'last');
finger_remove=zeros(1,6);
for i=1:length-1
    index1=i;
    index2=i+1;
    [a,index]=max(norm_distance(fingervalley(index1):fingervalley(index2)));
    if(a-norm_distance(fingervalley(index2))&lt;0.3)%a=norm_distance(finger(index1)+index-1)
        finger_remove(j)=index2;
        j=j+1;
    end
end
fingervalley(finger_remove(1:find(finger_remove, 1, 'last')))=[];

% find the fingertips of the hand
length=find(fingervalley, 1, 'last');
fingertip=zeros(1,5);
for i=1:length
    if(i==length)
        [a,index]=max(norm_distance(fingervalley(i):find(degree,1,'last')));
    else
        [a,index]=max(norm_distance(fingervalley(i):fingervalley(i+1)));
    end
    fingertip(i)=fingervalley(i)+index-1;
end

%remove invalid fingertip
length=find(fingertip,1,'last');
fingertip_max=max(norm_distance(fingertip(1:length)));
fingertip(norm_distance(fingertip(1:length))&lt;0.52*fingertip_max)=[];

%find the accurate positions of the edges of fingers
length=find(fingertip,1,'last');
fingeredge=zeros(1,2*length);
degree_dist=0;
fingervalley(length+1)=find(degree,1,'last');
for i=1:length
    index=fingertip(i)-1;
    while(true)
        [a,index1]=min(abs(norm_distance(fingertip(i):fingervalley(i+1))-norm_distance(index)));
        index1=fingertip(i)+index1-1;
        degree_dist1=degree(index1)-degree(index);
        if((length==1&amp;&amp;norm_distance(index1)&lt;0.4*norm_distance(fingertip(i))&amp;&amp;degree_dist~=0&amp;&amp;degree_dist1&gt;1.01*degree_dist)||index==fingervalley(i))
            break;
        elseif((norm_distance(index1)&lt;0.5*norm_distance(fingertip(i))&amp;&amp;norm_distance(index1)&lt;1.05*(max([norm_distance(fingervalley(i)),norm_distance(fingervalley(i+1))]))&amp;&amp;degree_dist~=0&amp;&amp;degree_dist1&gt;1.01*degree_dist)||index==fingervalley(i))
            break;
        end
        degree_dist=degree_dist1;
        index=index-1;
    end
    fingeredge([2*i-1,2*i])=[index,index1];
end

%narrow down the first and last finger
length=find(fingertip,1,'last');
flag1=1;
flag2=1;
if(length&gt;1)
    fingeredge_temp1=fingeredge(2);
    fingeredge_temp2=fingeredge(end-1);
    norm_distance_start=norm_distance(fingeredge(1));
    norm_distance_end=norm_distance(fingeredge(end));
    while(true)
        if(degree(fingeredge(end))-degree(fingeredge(end-1))&gt;0.07)%flag2&amp;&amp;degree(fingeredge(end))-degree(fingeredge_temp2)&gt;0.07
            fingeredge_temp2=fingeredge_temp2+1;
            [a,index]=min(abs(norm_distance(fingertip(length):fingeredge(end))-norm_distance(fingeredge_temp2)));
            fingeredge(end)=fingertip(length)+index-1;
        else
            if(norm_distance(fingeredge(end))&gt;1.2*norm_distance_end)

            flag2=0;
        end
        if(degree(fingeredge(2))-degree(fingeredge(1))&gt;0.07)%flag1&amp;&amp;degree(fingeredge_temp1)-degree(fingeredge(1))&gt;0.07
            fingeredge_temp1=fingeredge_temp1-1;
            [a,index]=min(abs(norm_distance(fingeredge(1):fingertip(1))-norm_distance(fingeredge_temp1)));
            fingeredge(1)=fingeredge(1)+index-1;
        else
            flag1=0;
        end
        if(~(flag1||flag2))
            break;
        end
    end
else
    fingeredge_temp=fingeredge(1);
    while(true)
        if(degree(fingeredge(end))-degree(fingeredge(1))&gt;0.08)
            fingeredge_temp=fingeredge_temp+1;
            [a,index]=min(abs(norm_distance(fingertip(1):fingeredge(end))-norm_distance(fingeredge_temp)));
            fingeredge(end)=fingertip(1)+index-1;
            fingeredge(1)=fingeredge_temp;
        else
            break;
        end
    end
end
end
</code></pre>

<p>After the fingerroots are found, there is still in need of some adjustment in order to achievement the best performance. This is done according to the assumption that no single finger width can surpass a certain threshold. The code is shown at the end.</p>

<h3>Plan B</h3>

<p>This method is under development:)</p>

  </section>
  <div style='height:1px;background-color:#C3C3C3;line-height:1px;clear:both;display:block;overflow:hidden'> </div>
  <br>
  <!--codes for Disqus-->
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'kaystechblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <!--end of code-->
</article>

        </div>
        <footer>
          <div>
            &copy; 2013 Kay | powered by jekyll | themed by <a href="http://lhzhang.com" title="sext vi">sext vi</a> | fork <a href="https://github.com/imkaywu/imkaywu.github.io" title="fork me">me</a>
          </div>
        </footer>
      </div> <!-- main -->
  </body>
</html>
