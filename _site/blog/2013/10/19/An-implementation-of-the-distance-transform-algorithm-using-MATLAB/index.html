<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <meta name=viewport content="width=device-width, initial-scale=1.0">
        <meta name=description content="Kay's Tech Blog">
        
        <title>A MATLAB implementation of distance transform algorithm | Kay Wu</title>

        <script src=http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js type=text/javascript></script>
        <script>
            MathJax.Hub.Config({
              "HTML-CSS": {
                linebreaks: {
                    automatic: true,
                    width: "70% container"
                },
                styles: {
                    ".MathJax .math": {
                        "border": "1px solid #ccc",
                        "margin": "0.1em 0",
                        "padding": "0.3em",
                        "vertical-align": "middle"
                    },
                    ".MathJax_Display .math": {
                        "border": "none",
                        "padding": "0",
                    }
                },
                scale: 90
              }
            });
        </script>
                
        <link rel=stylesheet type=text/css href=/assets/css/pure-min.css>
        <link rel=stylesheet type=text/css href=/assets/css/github.css>
        <link rel=stylesheet type=text/css href=/assets/css/styles.css>
        <link rel=stylesheet type=text/css href=/assets/css/font-awesome/css/font-awesome.min.css>
        <link rel=alternate type=application/rss+xml title="RSS feed for eyeshalfclosed.com" href="/feed.xml">
    </head>
    <body>
		<header>
			<div class="header">
  <div class="pure-menu pure-menu-fixed pure-menu-open pure-menu-horizontal">
    <a class="pure-menu-heading" style="padding: 8px 20px;" href="/">Kay Wu</a>
    <div class="phone expand-icon"><a class="clickable" onclick="toggleMenu()"><i class="icon-reorder"></i></a></div>
    <ul>
      <div id="links" class="hidden-phone">
        <li><a href="/categories/projects/">Projects</a></li>
        <br class="phone" />
        <li><a href="/categories/blog/">Blog</a></li>
        <br class="phone" />
        <li><a href="/categories/resume/">Resume</a></li>
      </div>
    </ul>
  </div>
</div>

		</header>
        <div class="container pure-g-r">
            <div class=pure-u-1-4>
                <div class=author-info>
    <img src="/images/author-image.jpeg" class=author-image />
    <h1 class=author-name><a href=/>Kay Wu</a></h1>
    <div class=nav>
        <a href="https://github.com/imkaywu"><i class=icon-github-alt></i></a>
        <a href="http://weibo.com/imkaywu"><i class=icon-weibo></i></a>
        <a href="https://linkedin.com/in/imkaywu"><i class=icon-linkedin></a></i>
        <a href="mailto:imkaywu@gmail.com"><i class=icon-envelope-alt></i></a>
    </div>
    <p class=author-bio>Electric Engineer student in BUPT.
A keen programmer and music & movie lover.
More <a href=/about.html>about me</a>.
</p>
</div>

            </div>
            <div class=pure-u-3-4>
                <div class=right-column>
                    <div class=post>
    
    <ul class=post-meta>
    
    <li class=publish-time><i class=icon-calendar></i>October 19, 2013</li>
    
        <li>&middot;</li>
        <li><a href="/categories/blog/#computer vision">#computer vision</a></li>
    
        <li>&middot;</li>
        <li><a href="/categories/blog/#image process">#image process</a></li>
    
        <li>&middot;</li>
        <li><a href="/categories/blog/#distance transform">#distance transform</a></li>
    
        <li>&middot;</li>
        <li><a href="/categories/blog/#MATLAB">#MATLAB</a></li>
    
</ul>

    <h1 class=title-large>A MATLAB implementation of distance transform algorithm</h1>
    <div class=content>
        <p>In the gesture recognition algorithms we are developing, I need to calculate the transform distance of a binary image. Though the MATLAB has a function for just that purpose, I decided to dig around and find more efficient ways to implement this algorithm.</p>

<p>For folks who are not familiar with distance transform, there is a great post[http://homepages.inf.ed.ac.uk/rbf/HIPR2/distance.htm] for you. This can give a big picture of what this task is about.</p>

<p>The algorithm I implement is using <strong>chessboard</strong> distance metric. And I&#39;m still working on some other metrics. For instance, <strong>Euclidean</strong> and <strong>city block</strong> metrics.</p>

<p>First, we assume that the pixel value of the object is 1, and that of the background is 0. Then distance transform is defined as the smallest distance between the object and background pixels. And this value is used to replace the pixel value of the object.</p>

<h2 id="logic-of-the-algorithm">Logic of the algorithm</h2>

<p>direction: up-left to bottom-right</p>

<p>for each pixel</p>

<pre><code>if the value is greater than 0 (namely, object pixel)

	get the pixels from the *left*, *up-left*, *up*, *up-right* directions

	add 1 to the minimum value, assign it to the object pixel

end if
</code></pre>

<p>end for</p>

<p>direction: bottom-right to up-left</p>

<p>for each pixel</p>

<pre><code>if the value is greater than 0 (namely, object pixel)

	get the pixels from the *right*, *bottom-right*, *bottom*, *bottom-left* directions

	add 1 to the minimum value, assign it to the object pixel

end if
</code></pre>

<p>end for</p>

<p>And the MATLAB code is as follows:</p>

<p>function dt=dist_trans(mat)
    row=size(mat,1);
    colum=size(mat,2);
    index0=(mat==0);
    index1=(mat==1);
    mat(index0)=1;
    mat(index1)=0;</p>

<pre><code>for i=1:row
    for j=1:colum
        if(mat(i,j)&gt;=1)
            if((i==1)&amp;&amp;(j==1));
            elseif(i==1)
                mat(i,j)=min(mat(i,j-1))+1;
            elseif(j==1)
                mat(i,j)=min([mat(i-1,j),mat(i-1,j+1)])+1;
            elseif(j==colum)
                mat(i,j)=min([mat(i,j-1),mat(i-1,j-1),mat(i-1,j)])+1;
            else
                mat(i,j)=min([mat(i,j-1),mat(i-1,j-1),mat(i-1,j),mat(i-1,j+1)])+1;
            end
        end
    end
end

for i=row:-1:1
    for j=colum:-1:1
        if(mat(i,j)&gt;=1)
            if((i==row)&amp;&amp;(j==colum));
            elseif(i==row)
                mat(i,j)=mat(i,j+1)+1;
            elseif(j==colum)
                mat(i,j)=min([mat(i+1,j),mat(i+1,j-1)])+1;
            elseif(j==1)
                mat(i,j)=min([mat(i,j+1),mat(i+1,j+1),mat(i+1,j)])+1;
            else
                mat(i,j)=min([mat(i,j+1),mat(i+1,j+1),mat(i+1,j),mat(i+1,j-1)])+1;
            end
        end
    end
end
dt=mat; end
</code></pre>

<p>The advantage of this algorithm is its simlicity and easy to understand. There are lots of research in improving this algorithm and I&#39;m just started my own research. So I hope more sophisticated and faster algorithms can come up later.</p>

    </div>
	<div style='height:1px;background-color:#C3C3C3;line-height:1px;clear:both;display:block;overflow:hidden'> </div>
	<br>
	<!--codes for Disqus-->
	<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'kaystechblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	<!--end of code-->
</div>

                </div>
            </div>
        </div>
		<!--codes to DISPLAY COMMENT COUNT-->
		<script type="text/javascript">
    	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    	var disqus_shortname = 'kaystechblog'; // required: replace example with your forum shortname

    	/* * * DON'T EDIT BELOW THIS LINE * * */
    	(function () {
        	var s = document.createElement('script'); s.async = true;
        	s.type = 'text/javascript';
        	s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        	(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    	}());
    	</script>
		<!--end of code-->
    </body>
</html>
