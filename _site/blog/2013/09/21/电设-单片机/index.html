<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <meta name=viewport content="width=device-width, initial-scale=1.0">
        <meta name=description content="Kay's Tech Blog">
        
        <title>C8051F单片机开发 | Kay Wu</title>

        <script src=http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js type=text/javascript></script>
        <script>
            MathJax.Hub.Config({
              "HTML-CSS": {
                linebreaks: {
                    automatic: true,
                    width: "70% container"
                },
                styles: {
                    ".MathJax .math": {
                        "border": "1px solid #ccc",
                        "margin": "0.1em 0",
                        "padding": "0.3em",
                        "vertical-align": "middle"
                    },
                    ".MathJax_Display .math": {
                        "border": "none",
                        "padding": "0",
                    }
                },
                scale: 90
              }
            });
        </script>
                
        <link rel=stylesheet type=text/css href=/assets/css/pure-min.css>
        <link rel=stylesheet type=text/css href=/assets/css/github.css>
        <link rel=stylesheet type=text/css href=/assets/css/styles.css>
        <link rel=stylesheet type=text/css href=/assets/css/font-awesome/css/font-awesome.min.css>
        <link rel=alternate type=application/rss+xml title="RSS feed for eyeshalfclosed.com" href="/feed.xml">
    </head>
    <body>
		<header>
			<div class="header">
  <div class="pure-menu pure-menu-fixed pure-menu-open pure-menu-horizontal">
    <a class="pure-menu-heading" style="padding: 8px 20px;" href="/">Kay Wu</a>
    <div class="phone expand-icon"><a class="clickable" onclick="toggleMenu()"><i class="icon-reorder"></i></a></div>
    <ul>
      <div id="links" class="hidden-phone">
        <li><a href="/categories/projects/">Projects</a></li>
        <br class="phone" />
        <li><a href="/categories/blog/">Blog</a></li>
        <br class="phone" />
        <li><a href="/categories/resume/">Resume</a></li>
      </div>
    </ul>
  </div>
</div>

		</header>
        <div class="container pure-g-r">
            <div class=pure-u-1-4>
                <div class=author-info>
    <img src="/images/author-image.jpeg" class=author-image />
    <h1 class=author-name><a href=/>Kay Wu</a></h1>
    <div class=nav>
        <a href="https://github.com/imkaywu"><i class=icon-github-alt></i></a>
        <a href="http://weibo.com/imkaywu"><i class=icon-weibo></i></a>
        <a href="https://linkedin.com/in/imkaywu"><i class=icon-linkedin></a></i>
        <a href="mailto:imkaywu@gmail.com"><i class=icon-envelope-alt></i></a>
    </div>
    <p class=author-bio>Electric Engineer student in BUPT.
A keen programmer and music & movie lover.
More <a href=/about.html>about me</a>.
</p>
</div>

            </div>
            <div class=pure-u-3-4>
                <div class=right-column>
                    <div class=post>
    
    <div class=feature-image>
        <img src="/images/C8051F.png"/>
    </div>
    
    <ul class=post-meta>
    
    <li class=publish-time><i class=icon-calendar></i>September 21, 2013</li>
    
        <li>&middot;</li>
        <li><a href="/categories/blog/#电设">#电设</a></li>
    
        <li>&middot;</li>
        <li><a href="/categories/blog/#单片机">#单片机</a></li>
    
</ul>

    <h1 class=title-large>C8051F单片机开发</h1>
    <div class=content>
        <p>可能这个题目起得有些大，但也不想纠结这种事了。这块单片机对于入门来说我觉得还是有些困难的。当我一开始看源代码时，有一种想屎一赤又一赤的冲动。因为它的寄存器太过于丰富，而且对于某一模块的寄存器需要进行正确的配置之后，你写的代码才有可能按照你的预想去执行（也就是说没有程序出来奇葩结果的原因有两个：1.配置问题；2.逻辑问题，而且你刚开始很难知道是哪个）。我主要想记录下我在这个平台上开发时发生的各种奇葩蛋疼的事情，各种无法用逻辑解释的现象。</p>

<h3 id="ad">AD模块</h3>

<p>这块真心没什么好说的，按着手册把寄存器配置好后，接收AD的输出数据就可以了。但关键是AD的精度并不是很准。当我输入给的是直流时，用串口输出AD输出值，数据竟然都有很大的波动。不过我之所以要记录这一块是因为这差不算是我正儿八经地学单片机程序后的第一个程序，对我观念上的转变还是挺大的。在软件中，当我要实现一个功能时，我必须自己思考逻辑，然后编出代码实现这个功能。但在硬件中，你要实现的功能都已经有硬件替你完成了，编程人员所要做的唯一要做的一件事情就是告诉硬件它要怎么获得输入，它该怎么处理这些输入，编程人员又该怎么得到它处理后的输出。至于它的处理过程，并不是编程人员考虑的。这一开始让我很不习惯，也让我感受到了硬件编程和软件编程第一个不一样的地方。</p>

<h3 id="da">DA模块</h3>

<p>这个我是和键盘一起做的，通过键盘控制输出的波形。其实还是如何给输入，给什么样的输入的问题。至于数字信号如何转变成模拟信号的，全有硬件来做。</p>

<h3 id="section">矩阵键盘</h3>

<p>之所以用矩阵键盘，是因为单片机的端口数量有限，矩阵键盘可以减少端口数的使用个数。但这也意味着键盘的检测就要稍微复杂一些了。</p>

<p><strong>矩阵键盘原理图</strong></p>

<p><img src="/images/keyboard.jpeg" alt="keyboard" /></p>

<p>如图所示，将行设为输入，列设为输出，我们要做的就是不停的对列进行扫描，同时检测行的电平。具体来说，对某一列输出一个低电平，如果没有任何按键被按下，则行一直为高电平。</p>

    </div>
	<div style='height:1px;background-color:#C3C3C3;line-height:1px;clear:both;display:block;overflow:hidden'> </div>
	<br>
	<!--codes for Disqus-->
	<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'kaystechblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	<!--end of code-->
</div>

                </div>
            </div>
        </div>
		<!--codes to DISPLAY COMMENT COUNT-->
		<script type="text/javascript">
    	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    	var disqus_shortname = 'kaystechblog'; // required: replace example with your forum shortname

    	/* * * DON'T EDIT BELOW THIS LINE * * */
    	(function () {
        	var s = document.createElement('script'); s.async = true;
        	s.type = 'text/javascript';
        	s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        	(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    	}());
    	</script>
		<!--end of code-->
    </body>
</html>
